# Kargo Configuration - Single Source of Truth
# Trunk-Based Development: all promotions commit to the main branch
# Flow: dev (auto) → staging (auto) → production (manual)

project: microsvcs
namespace: microsvcs
gitRepo: https://github.com/davidaparicio/microsvcs.git
gitBranch: main
dockerRegistry: quay.io/davidaparicio
kustomizeBasePath: k8s/overlays

services:
  - red
  - blue
  - green
  - yellow

environments:
  - name: development
    autoPromote: true
    warehouse:
      imageTagPattern: "^sha-.*"
      imageSelectionStrategy: NewestBuild
      discoveryLimit: 10

  - name: staging
    autoPromote: true
    warehouse:
      semverConstraint: ">=0.0.0"
      imageSelectionStrategy: SemVer
      discoveryLimit: 10

  - name: production
    autoPromote: false
    # Promoted from staging — no warehouse needed
